<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="./assets/index-data.js"></script>
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
  <title>- alex lau -</title>
  <style>
    @keyframes scroller {
      0% {
        transform: translateY(0);
      }
      100% {
        transform: translateY(-50%);
      }
    }
    @keyframes jump {
      0% {
        top: 0;
      }
      50% {
        top: 1rem;
      }
      100% {
        top: 0;
      }
    }
    @keyframes jump2 {
      0% {
        top: -5rem;
      }
      50% {
        top: -4rem;
      }
      100% {
        top: -5rem;
      }
    }
    * {
      font-family: monospace;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-size: 1.2rem;
      color: #fff;
    }
    html {
      font-size: 1vw;
    }
    @media (max-width: 1200px) {
      html {
        font-size: 12px;
      }
    }
    body {
      display: flex;
      overflow: hidden;
      background: #000;
    }
    main {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(25vh, 1fr));
      width: calc(var(--vh, 1vh) * 100);
      animation: scroller linear 20s infinite;
    }
    main:hover {
      animation-play-state: paused;
    }
    main > section {
      background-size: cover;
      transition: 500ms filter ease-in-out;
      filter: brightness(0.3);
    }
    main > section::before {
      content: "";
      padding-bottom: 100%;
      display: block;
    }
    main > section:hover {
      z-index: 1000;
      filter: brightness(1);
    }
    main > section:hover:after {
      position: absolute;
      content: "";
      top: -0.8rem;
      left: -0.8rem;
      width: 100%;
      height: 100%;
      display: block;
      border: 0.8rem solid #fff;
    }
    aside {
      transition: 500ms transform ease-in-out;
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 4rem;
      min-width: 400px;
      max-width: calc(100vw - 100vh);
      height: calc(var(--vh, 1vh) * 100);
    }
    aside.hidden {
      transform: translateY(100%);
    }
    .arrow {
      width: 100vw;
      text-align: center;
      left: 0;
      top: 0;
      position: absolute;
      font-size: 5rem;
      transform: rotate(180deg) translate(0, 2rem);
      animation: jump ease-in-out 1s infinite;
    }
    aside.hidden .arrow {
      top: -5rem;
      transform: none;
      animation: jump2 ease-in-out 1s infinite;
    }
    h1 {
      font-size: 4rem;
    }
    h2 {
      font-size: 3rem;
    }
    h3 {
      font-size: 2rem;
    }
    h4 {
      font-size: 1.6rem;
    }
    aside > div {
      margin-top: 1.4rem;
    }
    p {
      margin-top: 0.2rem;
    }
    p.right {
      text-align: right;
    }
    p:first-of-type {
      margin-top: auto;
    }
    a {
      color: #fff;
      text-decoration: none;
    }
    a:hover {
      border-bottom: 2px solid #fff;
    }

    @media (max-width: 480px) {
      main {
        width: 100vw;
        grid-template-columns: repeat(2, 1fr);
      }
      aside {
        position: absolute;
        width: 100vw;
        min-width: unset;
        max-width: unset;
      }
      .intro {
        display: none;
      }
    }
  </style>
</head>
<body>
  <main></main>
  <aside>
    <figure class="arrow">^</figure>
    <h1>alex lau</h1>
    <h3>- code</h3>
    <h3>- music</h3>
    <h3>- linguistics</h3>
    <div class="text">
      <p class="playing"><span></span></p>
      <p class="tip">hover on album covers for detail</p>
      <p class="intro"></p>
    </div>
    <p><a href="static/cv.pdf">cv</a></p>
    <p><a href="gd-radar.html">gd-radar</a></p>
    <p><a href="styled-latin.html">styled-latin</a></p>
    <p class="right"><a href="https://t.me/alejandrolau">@alejandrolau</a></p>
    <p class="right"><a href="mailto:alejandrolau@msn.cn">alejandrolau#msn.cn</a></p>
  </aside>
  <audio muted></audio>
  <script>
    const main = document.querySelector('main');
    function showIntro(info) {
      if (!info) {
        $('.intro').empty();
        $('.tip').text('hover on album covers for detail');
        return;
      }
      const { title, artist, year, comment } = info;
      $('.tip').text('click on cover to listen to track');
      const spans = `<br/>
      <strong>${title.split('').join('</strong><strong>')}</strong>
      <br/>
      <span>${`${artist} (${year})`.split('').join('</span><span>')}</span>
      <br/>
      <br/>
      <span>${comment.split('').join('</span><span>')}</span>`;
      $(spans).hide().appendTo('.intro').each(function (i) {
        $(this).delay(100 * i).css({
          display: 'inline',
          opacity: 0
        }).animate({
          opacity: 1
        }, 100);
      });
    };

    function playAudio (info) {
      const [player] = $('audio');
      if (!info) {
        player.src = '';
        player.pause();
        $('.playing').hide();
      }
      player.src = `./assets/audio/${info.id}.ogg`;
      player.play();
      player.muted = false;
      $('.playing').html(`<span></span> >> ${info.title} ${info.track}`);
      $('.playing').show();
    };

    const [player] = $('audio');
    player.addEventListener('timeupdate', () => {
      $('.playing span').text(`${Math.floor(player.currentTime / 60)}:${String(Math.floor(player.currentTime % 60)).padStart(2, '0')}`);
    });

    const [arrow] = $('aside figure');
    arrow.addEventListener('click', () => {
      $('aside').toggleClass('hidden');
    });

    [...data, ...data].forEach((info) => {
      const section = document.createElement('section');
      section.style.backgroundImage = `url('./assets/cover/${info.id}.jpg')`;
      section.onmouseover = () => {
        showIntro(info);
      };
      section.onmouseout = () => {
        showIntro();
      };
      section.onclick = () => {
        playAudio(info);
      };
      // document.onclick = (e) => {
      //   if (e.target.nodeName === 'SECTION') return;
      //   playAudio();
      // };
      main.appendChild(section);
    })
  </script>
</body>
</html>